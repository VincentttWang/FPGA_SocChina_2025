# FFT 顶层模块接口规范

## 1. 概述
`fft_top` 模块基于 Vitis DSP 库的 SSR（超采样率）FFT 实现，完成 1024 点快速傅里叶变换。该设计配置为 SSR 因子为 2，允许每个时钟周期处理 2 个采样点。

## 2. 接口摘要

| 接口名称 | 类型 | 协议 | 位宽 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| `s_axi_control` | Slave | AXI4-Lite | 32-bit | 控制与状态寄存器 (CSR)，用于启动/停止 IP 核。 |
| `in_stream` | Slave | AXI4-Stream | 64-bit | 输入数据流（时域）。 |
| `out_stream` | Master | AXI4-Stream | 64-bit | 输出数据流（频域）。 |

## 3. 数据格式

### 3.1 采样点类型
输入和输出采样点使用定点数表示的复数。
*   **类型**: `std::complex<ap_fixed<16, 1>>`
*   **实部**: 16 位 (1 位整数位, 15 位小数位)。
*   **虚部**: 16 位 (1 位整数位, 15 位小数位)。
*   **单个采样点总位宽**: 32 位。

### 3.2 数据流打包 (AXI4-Stream)
AXI4-Stream 接口位宽为 64 位，以适应 SSR=2 的配置（每周期 2 个采样点）。

**位映射:**

| 位范围 | 内容 | 描述 |
| :--- | :--- | :--- |
| `[15:0]` | 采样点 `k` 实部 | 当前周期第 1 个采样点的实部。 |
| `[31:16]` | 采样点 `k` 虚部 | 当前周期第 1 个采样点的虚部。 |
| `[47:32]` | 采样点 `k+1` 实部 | 当前周期第 2 个采样点的实部。 |
| `[63:48]` | 采样点 `k+1` 虚部 | 当前周期第 2 个采样点的虚部。 |

## 4. 配置参数

基于 `fft_config.hpp` 文件：

*   **变换长度 (N)**: 1024
*   **SSR 因子 (R)**: 2
*   **变换方向**: 正变换 (Forward)
*   **缩放模式**: `SSR_FFT_SCALE` (输出缩放)
*   **输出顺序**: 自然序 (Natural Order)
*   **蝶形运算舍入模式**: 截断 (`TRN`)

## 5. 控制寄存器映射 (AXI4-Lite)
该模块在 `control` 接口束上使用标准的 Vitis HLS 控制块。

*   **0x00**: 控制信号
    *   Bit 0: `ap_start` (读/写/COH) - 启动 IP
    *   Bit 1: `ap_done` (读/COR) - 完成标志
    *   Bit 2: `ap_idle` (读) - 空闲标志
    *   Bit 3: `ap_ready` (读) - 就绪标志
    *   Bit 7: `auto_restart` (读/写) - 自动重启
